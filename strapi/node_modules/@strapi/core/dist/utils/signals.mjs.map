{"version":3,"file":"signals.mjs","sources":["../../src/utils/signals.ts"],"sourcesContent":["import type { Core } from '@strapi/types';\n\nexport const destroyOnSignal = (strapi: Core.Strapi) => {\n  let signalReceived = false;\n\n  // For unknown reasons, we receive signals 2 times.\n  // As a temporary fix, we ignore the signals received after the first one.\n\n  const terminateStrapi = async () => {\n    if (!signalReceived) {\n      signalReceived = true;\n      await strapi.destroy();\n      process.exit();\n    }\n  };\n\n  ['SIGTERM', 'SIGINT'].forEach((signal) => {\n    process.on(signal, terminateStrapi);\n  });\n};\n"],"names":[],"mappings":"AAEa,MAAA,kBAAkB,CAAC,WAAwB;AACtD,MAAI,iBAAiB;AAKrB,QAAM,kBAAkB,YAAY;AAClC,QAAI,CAAC,gBAAgB;AACF,uBAAA;AACjB,YAAM,OAAO;AACb,cAAQ,KAAK;AAAA,IACf;AAAA,EAAA;AAGF,GAAC,WAAW,QAAQ,EAAE,QAAQ,CAAC,WAAW;AAChC,YAAA,GAAG,QAAQ,eAAe;AAAA,EAAA,CACnC;AACH;"}