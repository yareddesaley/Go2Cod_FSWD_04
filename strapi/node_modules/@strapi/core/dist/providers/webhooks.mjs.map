{"version":3,"file":"webhooks.mjs","sources":["../../src/providers/webhooks.ts"],"sourcesContent":["import { defineProvider } from './provider';\nimport { createWebhookStore, webhookModel } from '../services/webhook-store';\nimport createWebhookRunner from '../services/webhook-runner';\n\nexport default defineProvider({\n  init(strapi) {\n    strapi.get('models').add(webhookModel);\n\n    strapi.add('webhookStore', () => createWebhookStore({ db: strapi.db }));\n    strapi.add('webhookRunner', () =>\n      createWebhookRunner({\n        eventHub: strapi.eventHub,\n        logger: strapi.log,\n        configuration: strapi.config.get('server.webhooks', {}),\n        fetch: strapi.fetch,\n      })\n    );\n  },\n  async bootstrap(strapi) {\n    const webhooks = await strapi.get('webhookStore').findWebhooks();\n    if (!webhooks) {\n      return;\n    }\n\n    for (const webhook of webhooks) {\n      strapi.get('webhookRunner').add(webhook);\n    }\n  },\n});\n"],"names":["webhooks"],"mappings":";;;AAIA,MAAA,WAAe,eAAe;AAAA,EAC5B,KAAK,QAAQ;AACX,WAAO,IAAI,QAAQ,EAAE,IAAI,YAAY;AAE9B,WAAA,IAAI,gBAAgB,MAAM,mBAAmB,EAAE,IAAI,OAAO,GAAI,CAAA,CAAC;AAC/D,WAAA;AAAA,MAAI;AAAA,MAAiB,MAC1B,oBAAoB;AAAA,QAClB,UAAU,OAAO;AAAA,QACjB,QAAQ,OAAO;AAAA,QACf,eAAe,OAAO,OAAO,IAAI,mBAAmB,CAAA,CAAE;AAAA,QACtD,OAAO,OAAO;AAAA,MAAA,CACf;AAAA,IAAA;AAAA,EAEL;AAAA,EACA,MAAM,UAAU,QAAQ;AACtB,UAAMA,YAAW,MAAM,OAAO,IAAI,cAAc,EAAE;AAClD,QAAI,CAACA,WAAU;AACb;AAAA,IACF;AAEA,eAAW,WAAWA,WAAU;AAC9B,aAAO,IAAI,eAAe,EAAE,IAAI,OAAO;AAAA,IACzC;AAAA,EACF;AACF,CAAC;"}